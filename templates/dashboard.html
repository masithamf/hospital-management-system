{% extends "base.html" %}

{% block title %}Dashboard - Hospital Management System{% endblock %}

{% block content %}
<div class="px-4 sm:px-6 lg:px-8">
    <div class="sm:flex sm:items-center">
        <div class="sm:flex-auto">
            <h1 class="text-2xl font-semibold text-gray-900">Dashboard</h1>
            <p class="mt-2 text-sm text-gray-700">Overview of hospital system statistics and patient records.</p>
        </div>
        <div class="mt-4 sm:mt-0 sm:ml-16 sm:flex-none">
            <a href="/export"
                class="inline-flex items-center justify-center px-4 py-2 border border-transparent text-sm font-medium rounded-md text-white bg-green-600 hover:bg-green-700">
                Export to Excel
            </a>
        </div>
    </div>

    <!-- Stats -->
    <div class="mt-8">
        <div class="bg-white shadow rounded-lg p-6">
            <h3 class="text-lg font-medium text-gray-900">Statistics</h3>
            <dl class="mt-5 grid grid-cols-1 gap-5 sm:grid-cols-2">
                <div class="bg-gray-50 px-4 py-5 sm:px-6 rounded-lg">
                    <dt class="text-sm font-medium text-gray-500 truncate">Total Patients</dt>
                    <dd class="mt-1 text-3xl font-semibold text-indigo-600">{{ total_patients }}</dd>
                </div>
            </dl>
        </div>
    </div>

    <!-- Filters -->
    <div class="mt-8 bg-white shadow rounded-lg p-6">
        <h3 class="text-lg font-medium text-gray-900 mb-4">Filters</h3>
        <form method="GET" action="/dashboard" class="grid grid-cols-1 gap-y-6 gap-x-4 sm:grid-cols-3">
            <div>
                <label for="from_date" class="block text-sm font-medium text-gray-700">From Date</label>
                <div class="mt-1">
                    <input type="date" name="from_date" id="from_date"
                        class="shadow-sm focus:ring-indigo-500 focus:border-indigo-500 block w-full sm:text-sm border-gray-300 rounded-md">
                </div>
            </div>

            <div>
                <label for="to_date" class="block text-sm font-medium text-gray-700">To Date</label>
                <div class="mt-1">
                    <input type="date" name="to_date" id="to_date"
                        class="shadow-sm focus:ring-indigo-500 focus:border-indigo-500 block w-full sm:text-sm border-gray-300 rounded-md">
                </div>
            </div>

            <div>
                <label for="search" class="block text-sm font-medium text-gray-700">Search</label>
                <div class="mt-1">
                    <input type="text" name="search" id="search" placeholder="Search by name"
                        class="shadow-sm focus:ring-indigo-500 focus:border-indigo-500 block w-full sm:text-sm border-gray-300 rounded-md">
                </div>
            </div>

            <div class="sm:col-span-3">
                <button type="submit"
                    class="w-full inline-flex justify-center py-2 px-4 border border-transparent shadow-sm text-sm font-medium rounded-md text-white bg-indigo-600 hover:bg-indigo-700 focus:outline-none focus:ring-2 focus:ring-offset-2 focus:ring-indigo-500">
                    Apply Filters
                </button>
            </div>
        </form>
    </div>

    <!-- Patient Table -->
    <div class="mt-8 flex flex-col">
        <div class="-my-2 -mx-4 overflow-x-auto sm:-mx-6 lg:-mx-8">
            <div class="inline-block min-w-full py-2 align-middle md:px-6 lg:px-8">
                <div class="overflow-hidden shadow ring-1 ring-black ring-opacity-5 md:rounded-lg">
                    <table class="min-w-full divide-y divide-gray-300">
                        <thead class="bg-gray-50">
                            <tr>
                                <th scope="col"
                                    class="py-3.5 pl-4 pr-3 text-left text-sm font-semibold text-gray-900 sm:pl-6">ID</th>
                                <th scope="col"
                                    class="px-3 py-3.5 text-left text-sm font-semibold text-gray-900">Name</th>
                                <th scope="col" class="px-3 py-3.5 text-left text-sm font-semibold text-gray-900">Birth Date
                                </th>
                                <th scope="col" class="px-3 py-3.5 text-left text-sm font-semibold text-gray-900">Visit Date
                                </th>
                                <th scope="col" class="px-3 py-3.5 text-left text-sm font-semibold text-gray-900">Diagnosis
                                </th>
                                <th scope="col" class="px-3 py-3.5 text-left text-sm font-semibold text-gray-900">Treatment
                                </th>
                                <th scope="col" class="px-3 py-3.5 text-left text-sm font-semibold text-gray-900">Doctor</th>
                            </tr>
                        </thead>
                        <tbody class="divide-y divide-gray-200 bg-white">
                            {% for patient in patients %}
                            <tr>
                                <td class="whitespace-nowrap py-4 pl-4 pr-3 text-sm font-medium text-gray-900 sm:pl-6">
                                    {{ patient.id }}</td>
                                <td class="whitespace-nowrap px-3 py-4 text-sm font-medium text-gray-900">
                                    {{ patient.nama }}</td>
                                <td class="whitespace-nowrap px-3 py-4 text-sm text-gray-500">{{ patient.tanggal_lahir }}</td>
                                <td class="whitespace-nowrap px-3 py-4 text-sm text-gray-500">{{ patient.tanggal_kunjungan.strftime('%Y-%m-%d %H:%M') }}</td>
                                <td class="whitespace-nowrap px-3 py-4 text-sm text-gray-500">{{ patient.diagnosis }}</td>
                                <td class="whitespace-nowrap px-3 py-4 text-sm text-gray-500">{{ patient.tindakan }}</td>
                                <td class="whitespace-nowrap px-3 py-4 text-sm text-gray-500">{{ patient.dokter }}</td>
                            </tr>
                            {% endfor %}
                        </tbody>
                    </table>
                </div>
            </div>
        </div>
    </div>
</div>
{% endblock %}
